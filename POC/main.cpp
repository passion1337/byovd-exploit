#pragma warning(disable:4996)
#include "native.h"
#include "drv.h"
#include "utils.h"


int main()
{
	if (!driver::Load())
		return 0;

	if (!lenovo::setupSyscall())
		return 0;

	uint16_t mz = 0;
	PVOID ntoskrnl = utils::GetKernelModule("ntoskrnl", nullptr);
	if (ntoskrnl)
	{
		lenovo::MemCopy(&mz, ntoskrnl, 2);
		printf("\t*(short*)%p : %x\n", ntoskrnl, mz);

		uint64_t EProcess = lenovo::IoGetCurrentProcess();
		printf("\tCurrent EProcess : %016llX\n", EProcess);
	}
	driver::Unload();
	return 1;
}
